"use strict";(()=>{var e={};e.id=545,e.ids=[545],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},19801:e=>{e.exports=require("os")},55315:e=>{e.exports=require("path")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},6162:e=>{e.exports=require("worker_threads")},71568:e=>{e.exports=require("zlib")},87561:e=>{e.exports=require("node:fs")},84492:e=>{e.exports=require("node:stream")},72477:e=>{e.exports=require("node:stream/web")},12140:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>A,patchFetch:()=>h,requestAsyncStorage:()=>_,routeModule:()=>E,serverHooks:()=>g,staticGenerationAsyncStorage:()=>N});var s={};r.r(s),r.d(s,{GET:()=>d,OPTIONS:()=>m,runtime:()=>u});var n=r(49303),o=r(88716),a=r(60670),i=r(87070),p=r(16636),c=r.n(p);c().config({path:".env.local"}),c().config({path:".env"}),process.env.AZURE_OPENAI_ENDPOINT||(c().config({path:".env"}),c().config({path:"../.env.local"}),c().config({path:"../.env"}),c().config({path:"../../.env.local"}),c().config({path:"../../.env"}));let u="nodejs";function l(e){return e.headers.set("Access-Control-Allow-Origin","*"),e.headers.set("Access-Control-Allow-Headers","Content-Type"),e.headers.set("Access-Control-Allow-Methods","GET, OPTIONS"),e}async function d(){try{let e=process.env.AZURE_OPENAI_ENDPOINT||process.env.NEXT_PUBLIC_AZURE_OPENAI_ENDPOINT,t=process.env.AZURE_OPENAI_API_KEY||process.env.NEXT_PUBLIC_AZURE_OPENAI_API_KEY,s=process.env.AZURE_OPENAI_API_VERSION||process.env.NEXT_PUBLIC_AZURE_OPENAI_API_VERSION||"2025-01-01-preview",n=process.env.AZURE_OPENAI_COMPLETION_DEPLOYMENT||process.env.AZURE_OPENAI_CHAT_DEPLOYMENT||process.env.NEXT_PUBLIC_AZURE_OPENAI_COMPLETION_DEPLOYMENT||process.env.NEXT_PUBLIC_AZURE_OPENAI_CHAT_DEPLOYMENT;if(console.log(s,n,e,t),!e||!t)return l(i.NextResponse.json({error:"Missing endpoint or apiKey in env"},{status:500}));let o=String(e).trim().replace(/^http:\/\//i,"https://"),a=/\/openai\/deployments\//i.test(o);if(!a&&!n)return l(i.NextResponse.json({error:"Missing deployment name (AZURE_OPENAI_COMPLETION_DEPLOYMENT)"},{status:500}));let p={messages:[{role:"system",content:"You are a helpful assistant."},{role:"user",content:"Say 'hi'"}],temperature:0,max_tokens:5,model:n};if(a){let e=/[?&]api-version=/.test(o)?o:`${o}${o.includes("?")?"&":"?"}api-version=${encodeURIComponent(s)}`,r=new AbortController,n=setTimeout(()=>r.abort(),1e4);try{let n=await fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","api-key":t},body:JSON.stringify(p),signal:r.signal}),a=await n.text();if(!n.ok)return l(i.NextResponse.json({error:"Azure error",status:n.status,body:a,used:{endpoint:o,apiVersion:s}},{status:502}));let c={};try{c=JSON.parse(a)}catch{}let u=c?.choices?.[0]?.message?.content??a;return l(i.NextResponse.json({ok:!0,reply:u,used:{endpoint:o,apiVersion:s}}))}catch(e){return l(i.NextResponse.json({error:"REST call failed",message:String(e?.message||e),used:{endpoint:o,apiVersion:s}},{status:502}))}finally{clearTimeout(n)}}try{let{AzureOpenAI:e}=await Promise.all([r.e(181),r.e(854)]).then(r.bind(r,71854)),a=o.replace(/\/$/,""),c=new e({endpoint:a,apiKey:t,deployment:n,apiVersion:s}),u=await c.chat.completions.create({messages:p.messages,temperature:p.temperature,max_tokens:p.max_tokens,model:n}),d=u?.choices?.[0]?.message?.content||"";return l(i.NextResponse.json({ok:!0,reply:d,used:{endpoint:a,deployment:n,apiVersion:s}}))}catch(e){try{if(/\.openai\.azure\.com\/?$/i.test(o)){let{AzureOpenAI:e}=await Promise.all([r.e(181),r.e(854)]).then(r.bind(r,71854)),a=o.replace(/\.openai\.azure\.com\/?$/i,".cognitiveservices.azure.com/").replace(/\/$/,""),c=new e({endpoint:a,apiKey:t,deployment:n,apiVersion:s}),u=await c.chat.completions.create({messages:p.messages,temperature:p.temperature,max_tokens:p.max_tokens,model:n}),d=u?.choices?.[0]?.message?.content||"";return l(i.NextResponse.json({ok:!0,reply:d,used:{endpoint:a,deployment:n,apiVersion:s}}))}}catch{}return l(i.NextResponse.json({error:"SDK call failed",message:String(e?.message||e),used:{endpoint:o,deployment:n,apiVersion:s}},{status:502}))}}catch(e){return l(i.NextResponse.json({error:String(e?.message||e)},{status:500}))}}async function m(){return l(new i.NextResponse(null,{status:204}))}let E=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/ai/ping/route",pathname:"/api/ai/ping",filename:"route",bundlePath:"app/api/ai/ping/route"},resolvedPagePath:"C:\\Users\\127547.INDIA\\Documents\\enterprise-risk-management-dashboard\\server-next\\app\\api\\ai\\ping\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:_,staticGenerationAsyncStorage:N,serverHooks:g}=E,A="/api/ai/ping/route";function h(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:N})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[542],()=>r(12140));module.exports=s})();